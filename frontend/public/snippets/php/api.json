{
  "id": "php-api",
  "name": "API REST PHP",
  "description": "API REST avec validation et réponses JSON",
  "language": "php",
  "feature": "api",
  "code": "<?php\n\nheader('Content-Type: application/json');\nheader('Access-Control-Allow-Origin: *');\nheader('Access-Control-Allow-Methods: GET, POST, PUT, DELETE');\nheader('Access-Control-Allow-Headers: Content-Type');\n\n$method = $_SERVER['REQUEST_METHOD'];\n$path = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);\n$pathParts = explode('/', trim($path, '/'));\n\n// Route: /api/{{endpoint}}\nif ($pathParts[0] === 'api' && $pathParts[1] === '{{endpoint}}') {\n    switch ($method) {\n        case 'GET':\n            if (isset($pathParts[2])) {\n                // GET /api/{{endpoint}}/{id}\n                $id = filter_var($pathParts[2], FILTER_VALIDATE_INT);\n                if ($id === false) {\n                    http_response_code(400);\n                    echo json_encode(['error' => 'Invalid ID']);\n                    exit;\n                }\n                // Récupérer par ID\n                echo json_encode(['id' => $id, 'data' => []]);\n            } else {\n                // GET /api/{{endpoint}}\n                // Récupérer tous\n                echo json_encode(['data' => []]);\n            }\n            break;\n            \n        case 'POST':\n            $data = json_decode(file_get_contents('php://input'), true);\n            if (!$data) {\n                http_response_code(400);\n                echo json_encode(['error' => 'Invalid JSON']);\n                exit;\n            }\n            // Créer\n            http_response_code(201);\n            echo json_encode(['message' => 'Created', 'data' => $data]);\n            break;\n            \n        case 'PUT':\n            if (!isset($pathParts[2])) {\n                http_response_code(400);\n                echo json_encode(['error' => 'ID required']);\n                exit;\n            }\n            $id = filter_var($pathParts[2], FILTER_VALIDATE_INT);\n            $data = json_decode(file_get_contents('php://input'), true);\n            // Mettre à jour\n            echo json_encode(['message' => 'Updated', 'id' => $id]);\n            break;\n            \n        case 'DELETE':\n            if (!isset($pathParts[2])) {\n                http_response_code(400);\n                echo json_encode(['error' => 'ID required']);\n                exit;\n            }\n            $id = filter_var($pathParts[2], FILTER_VALIDATE_INT);\n            // Supprimer\n            http_response_code(204);\n            break;\n            \n        default:\n            http_response_code(405);\n            echo json_encode(['error' => 'Method not allowed']);\n    }\n} else {\n    http_response_code(404);\n    echo json_encode(['error' => 'Not found']);\n}",
  "variables": [
    {
      "name": "endpoint",
      "type": "text",
      "label": "Endpoint",
      "required": true,
      "description": "Nom de l'endpoint API",
      "placeholder": "users"
    },
    {
      "name": "includeCors",
      "type": "checkbox",
      "label": "Support CORS",
      "required": false,
      "description": "Ajouter les headers CORS",
      "defaultValue": true
    },
    {
      "name": "allowedMethods",
      "type": "multiselect",
      "label": "Méthodes HTTP autorisées",
      "required": true,
      "description": "Méthodes HTTP supportées",
      "defaultValue": ["GET", "POST", "PUT", "DELETE"],
      "options": [
        { "value": "GET", "label": "GET" },
        { "value": "POST", "label": "POST" },
        { "value": "PUT", "label": "PUT" },
        { "value": "DELETE", "label": "DELETE" },
        { "value": "PATCH", "label": "PATCH" }
      ]
    },
    {
      "name": "includeValidation",
      "type": "checkbox",
      "label": "Validation des données",
      "required": false,
      "description": "Ajouter la validation des données d'entrée",
      "defaultValue": true
    },
    {
      "name": "includeErrorHandling",
      "type": "checkbox",
      "label": "Gestion d'erreurs",
      "required": false,
      "description": "Ajouter la gestion d'erreurs complète",
      "defaultValue": true
    }
  ],
  "security": {
    "sqlInjection": true,
    "xss": true,
    "csrf": true
  }
}

