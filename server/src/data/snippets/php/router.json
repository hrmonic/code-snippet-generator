{
  "id": "php-router",
  "name": "Routeur PHP Simple",
  "description": "Routeur PHP avec gestion des méthodes HTTP et paramètres",
  "language": "php",
  "feature": "router",
  "code": "<?php\n\nclass Router {\n    private $routes = [];\n    private $middlewares = [];\n    \n    public function get($path, $handler) {\n        $this->addRoute('GET', $path, $handler);\n    }\n    \n    public function post($path, $handler) {\n        $this->addRoute('POST', $path, $handler);\n    }\n    \n    public function put($path, $handler) {\n        $this->addRoute('PUT', $path, $handler);\n    }\n    \n    public function delete($path, $handler) {\n        $this->addRoute('DELETE', $path, $handler);\n    }\n    \n    private function addRoute($method, $path, $handler) {\n        $this->routes[] = [\n            'method' => $method,\n            'path' => $path,\n            'handler' => $handler\n        ];\n    }\n    \n    public function middleware($middleware) {\n        $this->middlewares[] = $middleware;\n    }\n    \n    public function dispatch() {\n        $method = $_SERVER['REQUEST_METHOD'];\n        $path = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);\n        \n        // Exécuter les middlewares\n        foreach ($this->middlewares as $middleware) {\n            if (is_callable($middleware)) {\n                $middleware();\n            }\n        }\n        \n        foreach ($this->routes as $route) {\n            if ($route['method'] === $method && $this->matchPath($route['path'], $path)) {\n                $params = $this->extractParams($route['path'], $path);\n                \n                if (is_callable($route['handler'])) {\n                    call_user_func_array($route['handler'], $params);\n                } else if (is_string($route['handler'])) {\n                    list($controller, $method) = explode('@', $route['handler']);\n                    $controllerInstance = new $controller();\n                    call_user_func_array([$controllerInstance, $method], $params);\n                }\n                \n                return;\n            }\n        }\n        \n        http_response_code(404);\n        echo json_encode(['error' => 'Route not found']);\n    }\n    \n    private function matchPath($routePath, $requestPath) {\n        $routePattern = preg_replace('/\\{[^}]+\\}/', '([^/]+)', $routePath);\n        $routePattern = '#^' . $routePattern . '$#';\n        return preg_match($routePattern, $requestPath);\n    }\n    \n    private function extractParams($routePath, $requestPath) {\n        preg_match_all('/\\{([^}]+)\\}/', $routePath, $paramNames);\n        $routePattern = preg_replace('/\\{[^}]+\\}/', '([^/]+)', $routePath);\n        $routePattern = '#^' . $routePattern . '$#';\n        \n        preg_match($routePattern, $requestPath, $matches);\n        array_shift($matches); // Retirer le match complet\n        \n        $params = [];\n        foreach ($paramNames[1] as $index => $name) {\n            $params[$name] = $matches[$index] ?? null;\n        }\n        \n        return $params;\n    }\n}\n\n// Utilisation\n$router = new Router();\n\n// Middleware\n$router->middleware(function() {\n    header('Content-Type: application/json');\n});\n\n// Routes\n$router->get('/api/users', function() {\n    echo json_encode(['users' => []]);\n});\n\n$router->get('/api/users/{id}', function($id) {\n    echo json_encode(['user' => ['id' => $id]]);\n});\n\n$router->post('/api/users', function() {\n    $data = json_decode(file_get_contents('php://input'), true);\n    echo json_encode(['message' => 'User created', 'data' => $data]);\n});\n\n$router->put('/api/users/{id}', function($id) {\n    $data = json_decode(file_get_contents('php://input'), true);\n    echo json_encode(['message' => 'User updated', 'id' => $id]);\n});\n\n$router->delete('/api/users/{id}', function($id) {\n    echo json_encode(['message' => 'User deleted', 'id' => $id]);\n});\n\n$router->dispatch();",
  "variables": [],
  "security": {
    "sqlInjection": false,
    "xss": true,
    "csrf": true
  }
}

